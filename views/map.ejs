<% include header.ejs %>

<script type="text/javascript">
	var images = {};

	/*
		Pre-loads the images so they can be drawn in order.
	*/
	function loadImages(messageboards) {
		var sources = ["campus_map.png", "icon.png"]
		var loadedImages = 0;

		for (var src in sources) {
			images[src] = new Image();
			images[src].onload = function() {
				if(++loadedImages >= 2) {
					drawImages(messageboards);
				}
			};
			images[src].src = sources[src];
		}
	}

	/*
		Draws the map and all the current messageboard locations onto the canvas.
	*/
	function drawImages(messageboards) {
		var canvas = document.getElementById('canvas');
		var ctx = canvas.getContext('2d');

		ctx.canvas.width = window.innerWidth;
		ctx.canvas.height = window.innerHeight;

		ctx.drawImage(images[0], 0, 0, window.innerWidth, window.innerHeight);

		for (var i = 0; i < messageboards.length; i++) {
			var messageboard = messageboards[i];

			ctx.drawImage(images[1], messageboard.x_coordinate * window.innerWidth, messageboard.y_coordinate * window.innerHeight, 20, 20);
		}
	}

	var canvas = document.getElementById('canvas');
	canvas.onClick = function() {
		alert("CLICK");
	}
	</script>
</head>

<body onload="loadImages(<%= messageboards %>);">
  <% include menu %>
	<canvas id="canvas"></canvas>

<% include footer.ejs %>